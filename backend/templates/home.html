{% extends "base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/home.css' %}">
{% endblock %}

{% block title %}Accueil - Location entre Particuliers{% endblock %}

{% block content %}
<section>
    <h1>Bienvenue sur notre plateforme de location entre particuliers</h1>
    <p>Louez facilement des objets, équipements ou espaces autour de vous.</p>

    {% if user.is_authenticated %}
        <a href="/api/Object/" class="centered-btn">Voir les objets disponibles</a>

        {% if contrats_non_signes %}
            <div class="alert alert-warning">
                Vous avez des contrats à signer :
                <ul>
                    {% for contrat in contrats_non_signes %}
                        <li>
                            Contrat pour {{ contrat.reservation.objet.nom }}

                            <!-- Bouton Lire -->
                            <button onclick="toggleContrat('contrat-{{ contrat.id }}')">Lire le contrat</button>

                            <!-- Bloc caché contenant le texte du contrat -->
                            <div id="contrat-{{ contrat.id }}" style="display: none; margin-top: 10px; border: 1px solid #ccc; padding: 10px;">
                                {{ contrat.texte|linebreaks }}
                            </div>

                            <!-- Formulaire de signature -->
                            <form method="post" action="{% url 'signer_contrat' contrat.id %}">
                                {% csrf_token %}
                                <button type="submit">Signer</button>
                            </form>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}
    {% else %}
    <div class="button-container">
        <a href="/api/Register/" class="centered-btn">Créer un compte</a> 
    
        <a href="/api/Login" class="centered-btn">Se connecter</a>
    </div>
    {% endif %}
</section>

<!-- JavaScript pour afficher/masquer le contrat -->
<script>
function toggleContrat(id) {
    var bloc = document.getElementById(id);
    bloc.style.display = bloc.style.display === 'none' ? 'block' : 'none';
}
</script>
{% endblock %}
